@inject Microsoft.AspNetCore.Identity.SignInManager<CondosmartWeb.Models.ApplicationUser> SignInManager
@inject Microsoft.AspNetCore.Identity.UserManager<CondosmartWeb.Models.ApplicationUser> UserManager
<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - Condosmart</title>

	<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>

<body>
	<div class="cs-shell">

		<div id="csOverlay" class="cs-overlay" onclick="toggleSidebar(false)"></div>

		<aside id="csSidebar" class="cs-sidebar">
			<div class="cs-brand">
				<div class="cs-brand-badge">C</div>
				<div>
					<div>CONDOMÍNIO</div>
					<small class="text-muted">CondoSmart</small>
				</div>
			</div>

			<div class="cs-search">
				<input class="form-control" placeholder="Procurar..." />
			</div>

		<nav class="cs-nav d-grid gap-2">
				<a asp-controller="Home" asp-action="Index">
					&#127968; Home
				</a>

				@* ── Apenas Admin ─────────────────────────────── *@
				@if (User.IsInRole("Admin"))
				{
					<a asp-controller="Condominio" asp-action="Index">
						&#127970; Condomínios
					</a>
				}

				@* ── Admin e Síndico ───────────────────────────── *@
				@if (User.IsInRole("Admin") || User.IsInRole("Sindico"))
				{
					<a asp-controller="UnidadesResidenciais" asp-action="Index">
						&#127961; Unidades Residenciais
					</a>

					<a asp-controller="Sindico" asp-action="Index">
						&#129333; Síndico
					</a>

					<a asp-controller="Visitante" asp-action="Index">
						&#128100; Visitantes
					</a>

					<a asp-controller="Morador" asp-action="Index">
						&#128101; Moradores
					</a>

					<a asp-controller="AreaDeLazer" asp-action="Index">
						&#127946; Áreas de Lazer
					</a>
				}

				@* ── Todos os perfis autenticados ─────────────── *@
					<a asp-controller="Ata" asp-action="Index">
						&#128203; Atas
					</a>

					<a asp-controller="Reserva" asp-action="Index">
						&#128197; Reservas
					</a>

					<a asp-controller="Mensalidades" asp-action="Index">
						&#128178; Mensalidades
					</a>

					<a asp-controller="Chamado" asp-action="Index">
						&#128172; Chamados
					</a>

				</nav>
		</aside>

		<div class="cs-main">

			<header class="cs-topbar">
				<div class="d-flex align-items-center gap-2">
				<button class="btn btn-cs-outline d-lg-none" type="button" onclick="toggleSidebar(true)">
					&#9776;
				</button>
					<div class="title">@ViewData["Title"]</div>
				</div>

				<div class="cs-top-actions">
					@if (SignInManager.IsSignedIn(User))
					{
						var nomeUsuario = UserManager.GetUserName(User) ?? "Usuário";
						<span class="me-2 text-muted small">&#128100; @nomeUsuario</span>
						@if (User.IsInRole("Admin") || User.IsInRole("Sindico"))
						{
							<a asp-area="Identity" asp-page="/Account/Register" class="btn btn-sm btn-outline-success me-1">&#10133; Registrar</a>
						}
						<form asp-area="Identity" asp-page="/Account/Logout" method="post" class="d-inline">
							<button type="submit" class="btn btn-sm btn-outline-danger">&#128275; Sair</button>
						</form>
					}
					else
					{
						<a asp-area="Identity" asp-page="/Account/Login" class="btn btn-sm btn-primary">&#128274; Entrar</a>
					}
				</div>
			</header>

			<main class="container py-4">
				@RenderBody()
			</main>

			<footer class="text-muted py-3">
				<div class="container">
					&copy; 2026 - Condosmart
				</div>
			</footer>
		</div>
	</div>

	<script src="~/lib/jquery/dist/jquery.min.js"></script>
	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="~/js/site.js" asp-append-version="true"></script>

	<script>
		function toggleSidebar(open) {
		const sidebar = document.getElementById('csSidebar');
		const overlay = document.getElementById('csOverlay');
		if (!sidebar || !overlay) return;

		if (open) {
		sidebar.classList.add('open');
		overlay.classList.add('show');
		} else {
		sidebar.classList.remove('open');
		overlay.classList.remove('show');
		}
		}
	</script>

	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>